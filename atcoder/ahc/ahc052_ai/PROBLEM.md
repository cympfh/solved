# A - Single Controller Multiple Robots  / 

実行時間制限: 2 sec / メモリ制限: 1024 MiB

## ストーリー
AtCoder社の高橋社長は、オフィス環境改善のため、最新式のワックスがけロボットを複数台導入した。
これでオフィスの床がピカピカになると安心したのも束の間、重大な問題が発覚した。
操作に必要なコントローラーをたった一つしか注文していなかったのである。
通常であれば絶望的な状況だが、幸いにもそのコントローラーは高度な「キーコンフィグ」機能を備えていた。 各ボタンに対して、ロボットごとに個別の行動を設定できる高機能な装置である。
高橋社長は、あなたにこの難題の解決を依頼した。 限られた手段を駆使して、オフィス全体の床に効率よくワックスがけを行ってほしい。

## 問題文
N×N マスのオフィスがある。
左上のマスの座標を (0,0) とし、下方向に i、右方向に j 進んだ位置の座標を (i,j) とする。 
N×N マスの外周は壁で囲まれており、隣接するマス間にも壁が存在する場合がある。

M 台のロボットを使って、全てのマスにワックスがけを行いたい。 
k 番目のロボットの初期位置は  (i_k, j_k) であり、初期位置を含め、ロボットが一度でも移動したマスはワックスがけされたとみなされる。

すべてのロボットは一つのコントローラーで同時に操作される。
このコントローラーには K 個のボタンがあり、ワックスがけを開始する前に、各ボタンと各ロボットの組に対して、上下左右の隣接マスへの移動、またはその場での待機の計 5 通りの行動のうちいずれかを設定しておく。
ボタンを押すと、全てのロボットが同時に対応する行動を実行する。
ボタンごとの設定はロボットごとに異なってよく、たとえば「ボタン 0 でロボット 0 は上に移動し、ロボット 1 は下に移動する」といった設定が可能である。 ワックスがけの開始後にボタンの割当を変更することはできない。

ロボットが移動しようとしたとき、移動先との間に壁がある場合、そのロボットはその場にとどまる。 ロボット同士は互いに干渉せず、同じマスに複数のロボットが存在してもよい。

操作は最大で $2 N^2$ 回まで行うことができる。
ボタンの割当と操作順を工夫することで、できるだけ少ない操作回数で全てのマスにワックスがけを施してほしい。

## 得点
出力した操作列の長さを T (ただし $T \leq 2 N^2$) 、ワックスがけされなかったマスの個数を R としたとき、以下の得点が得られる。

R=0 の場合、 $3N^2 - T$ 点,
R>0 の場合、 $N^2 - R$ 点. 

合計で 150 個のテストケースがあり、各テストケースの得点の合計が提出の得点となる。 一つ以上のテストケースで不正な出力や制限時間超過をした場合、提出全体の判定がやとなる。 コンテスト時間中に得た最高得点で最終順位が決定され、コンテスト終了後のシステムテストは行われない。 同じ得点を複数の参加者が得た場合、提出時刻に関わらず同じ順位となる。

## 入力
入力は以下の形式で標準入力から与えられる。

```
N M K
i_0 j_0
⋮
i_{M-1} j_{M-1} 

v_{0,0} ... v _{0,N−2}
⋮
v_{N−1,0} ... v_{N−1,N−2}
h_{0,0} ...  h_{0,N−1}
⋮
h_{N−2,0} ... h_{N−2,N−1}
```

- 全てのテストケースにおいて、 N=30、 M=10、 K=10 に固定されている。
- (i_k, j_k) は k 台目のロボットの初期位置を表し、全ての初期位置は互いに異なる。
- v_{i,0}...v_{i,N-2} は長さ N−1 の 01 からなる文字列であり、 j 文字目 v_{i,j} はマス (i,j) とマス 
(i,j+1) の間に壁がある（1）かない（0）かを表す。
- h_{i,0} ... h_{i,N-1} は長さ N の 01 からなる文字列であり、 j 文字目 h_{i,j} はマス (i,j) とマス (i+1,j) の間に壁がある（1）かない（0）かを表す。
- 全てのマスは互いに到達可能であることが保証されている。

## 出力
まず、ボタンの割当を以下の形式で標準出力に出力せよ。

```
c_{0,0} ... c_{0,M−1}
⋮
c_{K−1,0} ... c_{K−1,M−1}
```

ここで、 c_{i,j} は 
i 番目のボタンを押した際に j 番目のロボットが取る行動を表す 1 文字であり、次の 5 種類のいずれかである。

- U: 上方向に 1 マス移動
- D: 下方向に 1 マス移動
- L: 左方向に 1 マス移動
- R: 右方向に 1 マス移動
- S: その場にとどまる

その後、操作列を以下の形式で出力する。

```
a_0
a_{T−1}
```
 
ここで、 a_t は t ターン目に押すボタンを表す 0 以上 K−1 以下の整数値である。


## 入力例

```
30 10 10
13 25
7 14
17 22
0 18
29 1
3 25
14 22
14 29
26 2
3 10
00000000010000000000001000000
00000000010000000000001000000
00000000010000000000001000000
00000000010000000000001000000
00000000010000000000001000000
00000000010000000000001000000
00000000010000000000001000000
00000000000000000000001000000
00000000000000000000001000000
00000000000000000000001000000
00000000000000000000001000000
00000000000000000000000000000
00000000000000000000000000000
00000000000000000000000000000
00000000000000000000000000000
00000000000000000000000000000
00000000000000000000000000000
00000000000000000000000000000
00000000000000000000000000000
00000000000000000000000000000
00000000000000010000000000000
00000000000000010000000000000
00000000000000010000000000000
00000000000000010000000000000
00000000000000010000000000000
00000000000000010000000000000
00000000000000010000000000000
00000000000000010000000000000
00000000000000010000000000000
00000000000000010000000000000
000000000000000000000000000000
000000000000000000000000000000
000000000000000000000000000000
000000000000000000000000000000
000000000000000000000000000000
000000000000000000000000000000
000000000000000000000000000000
000000000000000000000000000000
000000000000000000000000000000
000000000000000000000000000000
000000000000000000000000000000
000000000000000000000000000000
000000000000000000000000000000
000000000000000000000000000000
011111111111111111100000000000
000000000000000000000000000000
000000000000000000000000000000
000000000000000000000000000000
000000000000000000000000000000
000000000000000000000000000000
000000000000000000000000000000
000000000000000000000000000000
111111111110000000000000000000
000000000000000000000000000000
000000000000000000000000000000
000000000000000000000000000000
000000000000000000000000000000
000000000000000000000000000000
000000000000000000000000000000
```

## 出力例
```
L L L R U R S D L S
R L L L D D L R D D
D S R D D S U D U R
L U S R D L S U L R
L U U L L U D U D L
L S U U S D L D U U
D D D D U D S D U S
U S U D S U L S D L
D R R R L L L S L S
L R S U S R D D R L
6
1
0
2
3
3
0
0
2
0
7
7
0
7
4
7
8
2
2
0
```
